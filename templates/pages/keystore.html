{{define "keystore.html"}}
{{template "base" .}}
{{end}}

{{define "content"}}
{{if .Error}}
<div class="alert alert-error">{{.Error}}</div>
{{end}}

{{if .Empty}}
<section class="info-card">
  <h2>Keystore</h2>
  <p class="empty-message">Keystore is empty.</p>
</section>
{{end}}

{{if .SymmetricKeys}}
<section class="info-card">
  <h2>Symmetric Keys</h2>
  <table class="disk-table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Format</th>
        <th>Value</th>
      </tr>
    </thead>
    <tbody>
      {{range .SymmetricKeys}}
      <tr>
        <td>{{.Name}}</td>
        <td>{{.Format}}</td>
        <td><code>{{.Value}}</code></td>
      </tr>
      {{end}}
    </tbody>
  </table>
</section>
{{end}}

{{if .AsymmetricKeys}}
<section class="info-card">
  <h2>Asymmetric Keys</h2>
  <table class="disk-table">
    <thead>
      <tr>
        <th>Name</th>
        <th>Algorithm</th>
        <th>Public Key</th>
        {{if (index .AsymmetricKeys 0).PrivateKeyFull}}<th>Private Key</th>{{end}}
        <th>Certificates</th>
      </tr>
    </thead>
    <tbody>
      {{range .AsymmetricKeys}}
      <tr>
        <td>{{.Name}}</td>
        <td>{{.Algorithm}}</td>
        <td>{{if .PublicKeyFull}}<code class="key-full">{{.PublicKeyFull}}</code>{{else}}-{{end}}</td>
        {{if .PrivateKeyFull}}
        <td><code class="key-full">{{.PrivateKeyFull}}</code></td>
        {{end}}
        <td>{{range $i, $c := .Certificates}}{{if $i}}, {{end}}{{$c}}{{end}}</td>
      </tr>
      {{end}}
    </tbody>
  </table>
</section>
{{end}}
{{end}}
